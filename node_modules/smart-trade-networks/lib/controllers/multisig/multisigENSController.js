"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _typeof = require("@babel/runtime/helpers/typeof");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.MultisigENSController = void 0;

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _ethers = require("ethers");

var _prefabContractFactory = require("../../chain/prefabContractFactory");

var artifact = _interopRequireWildcard(require("../../ethereum/abi/MultisigENS.json"));

var _encodeCall = require("../../ethereum/encodeCall");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

var MultisigENSController = /*#__PURE__*/function () {
  function MultisigENSController(multisigAddress, signerOrProvider) {
    (0, _classCallCheck2["default"])(this, MultisigENSController);
    (0, _defineProperty2["default"])(this, "_signer", void 0);
    (0, _defineProperty2["default"])(this, "_multisigENSAddress", void 0);
    (0, _defineProperty2["default"])(this, "_multisigENSContract", void 0);
    this._multisigENSAddress = multisigAddress;

    if (signerOrProvider instanceof _ethers.Signer || signerOrProvider instanceof _ethers.ethers.providers.JsonRpcSigner) {
      this._signer = signerOrProvider;
    } else {
      var web3Wrapper = new _ethers.ethers.providers.Web3Provider(signerOrProvider);
      this._signer = web3Wrapper.getSigner();
    }
  }

  (0, _createClass2["default"])(MultisigENSController, [{
    key: "_getMultisigENSContract",
    value: function () {
      var _getMultisigENSContract2 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee() {
        var contract;
        return _regenerator["default"].wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!this._multisigENSContract) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt("return", this._multisigENSContract);

              case 2:
                _context.prev = 2;
                _context.next = 5;
                return (0, _prefabContractFactory.getMultisigENSContract)(this._multisigENSAddress, this._signer);

              case 5:
                contract = _context.sent;
                this._multisigENSContract = contract;
                return _context.abrupt("return", contract);

              case 10:
                _context.prev = 10;
                _context.t0 = _context["catch"](2);
                throw Error("Failed to get Multisig contract: ".concat(_context.t0));

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this, [[2, 10]]);
      }));

      function _getMultisigENSContract() {
        return _getMultisigENSContract2.apply(this, arguments);
      }

      return _getMultisigENSContract;
    }()
    /**Getters */

  }, {
    key: "getContract",
    value: function () {
      var _getContract = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2() {
        var contract;
        return _regenerator["default"].wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _context2.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context2.sent;
                return _context2.abrupt("return", contract);

              case 4:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function getContract() {
        return _getContract.apply(this, arguments);
      }

      return getContract;
    }()
  }, {
    key: "getMultisigDeployerAddress",
    value: function () {
      var _getMultisigDeployerAddress = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee3() {
        var contract;
        return _regenerator["default"].wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context3.sent;
                return _context3.abrupt("return", contract.getMultisigDeployerAddress());

              case 4:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this);
      }));

      function getMultisigDeployerAddress() {
        return _getMultisigDeployerAddress.apply(this, arguments);
      }

      return getMultisigDeployerAddress;
    }()
  }, {
    key: "getMultisigName",
    value: function () {
      var _getMultisigName = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee4(msigAddress) {
        var contract;
        return _regenerator["default"].wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context4.sent;
                return _context4.abrupt("return", contract.getMultisigName(msigAddress));

              case 4:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      }));

      function getMultisigName(_x) {
        return _getMultisigName.apply(this, arguments);
      }

      return getMultisigName;
    }()
  }, {
    key: "getUserName",
    value: function () {
      var _getUserName = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee5(userAddress) {
        var contract;
        return _regenerator["default"].wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context5.sent;
                return _context5.abrupt("return", contract.getUserName(userAddress));

              case 4:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function getUserName(_x2) {
        return _getUserName.apply(this, arguments);
      }

      return getUserName;
    }()
    /**Setters */

  }, {
    key: "setMultisigDeployerAddress",
    value: function () {
      var _setMultisigDeployerAddress = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee6(address) {
        var contract;
        return _regenerator["default"].wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                _context6.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context6.sent;
                return _context6.abrupt("return", contract.functions.setMultisigDeployerAddress(address));

              case 4:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this);
      }));

      function setMultisigDeployerAddress(_x3) {
        return _setMultisigDeployerAddress.apply(this, arguments);
      }

      return setMultisigDeployerAddress;
    }()
  }, {
    key: "setUserName",
    value: function () {
      var _setUserName = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee7(name) {
        var contract;
        return _regenerator["default"].wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                _context7.next = 2;
                return this._getMultisigENSContract();

              case 2:
                contract = _context7.sent;
                return _context7.abrupt("return", contract.functions.setUserName(name));

              case 4:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, this);
      }));

      function setUserName(_x4) {
        return _setUserName.apply(this, arguments);
      }

      return setUserName;
    }()
    /** Helpers */

  }], [{
    key: "encodeCall",
    value: function encodeCall(functionName, args) {
      return (0, _encodeCall.encode)(artifact, functionName, args);
    }
  }, {
    key: "decodeCall",
    value: function decodeCall(data) {
      return (0, _encodeCall.decode)(artifact, data);
    }
  }]);
  return MultisigENSController;
}();

exports.MultisigENSController = MultisigENSController;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb250cm9sbGVycy9tdWx0aXNpZy9tdWx0aXNpZ0VOU0NvbnRyb2xsZXIudHMiXSwibmFtZXMiOlsiTXVsdGlzaWdFTlNDb250cm9sbGVyIiwibXVsdGlzaWdBZGRyZXNzIiwic2lnbmVyT3JQcm92aWRlciIsIl9tdWx0aXNpZ0VOU0FkZHJlc3MiLCJTaWduZXIiLCJldGhlcnMiLCJwcm92aWRlcnMiLCJKc29uUnBjU2lnbmVyIiwiX3NpZ25lciIsIndlYjNXcmFwcGVyIiwiV2ViM1Byb3ZpZGVyIiwiZ2V0U2lnbmVyIiwiX211bHRpc2lnRU5TQ29udHJhY3QiLCJjb250cmFjdCIsIkVycm9yIiwiX2dldE11bHRpc2lnRU5TQ29udHJhY3QiLCJnZXRNdWx0aXNpZ0RlcGxveWVyQWRkcmVzcyIsIm1zaWdBZGRyZXNzIiwiZ2V0TXVsdGlzaWdOYW1lIiwidXNlckFkZHJlc3MiLCJnZXRVc2VyTmFtZSIsImFkZHJlc3MiLCJmdW5jdGlvbnMiLCJzZXRNdWx0aXNpZ0RlcGxveWVyQWRkcmVzcyIsIm5hbWUiLCJzZXRVc2VyTmFtZSIsImZ1bmN0aW9uTmFtZSIsImFyZ3MiLCJhcnRpZmFjdCIsImRhdGEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUdBOztBQUNBOzs7Ozs7SUFLYUEscUI7QUFLVCxpQ0FBWUMsZUFBWixFQUFxQ0MsZ0JBQXJDLEVBQXlFO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDckUsU0FBS0MsbUJBQUwsR0FBMkJGLGVBQTNCOztBQUVBLFFBQUdDLGdCQUFnQixZQUFZRSxjQUE1QixJQUFzQ0YsZ0JBQWdCLFlBQVlHLGVBQU9DLFNBQVAsQ0FBaUJDLGFBQXRGLEVBQXFHO0FBQ2pHLFdBQUtDLE9BQUwsR0FBZU4sZ0JBQWY7QUFDSCxLQUZELE1BRU87QUFDSCxVQUFNTyxXQUFXLEdBQUcsSUFBSUosZUFBT0MsU0FBUCxDQUFpQkksWUFBckIsQ0FBa0NSLGdCQUFsQyxDQUFwQjtBQUNBLFdBQUtNLE9BQUwsR0FBZUMsV0FBVyxDQUFDRSxTQUFaLEVBQWY7QUFDSDtBQUNKOzs7OzttSEFFRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxxQkFDTyxLQUFLQyxvQkFEWjtBQUFBO0FBQUE7QUFBQTs7QUFBQSxpREFFZSxLQUFLQSxvQkFGcEI7O0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBTytCLG1EQUF1QixLQUFLVCxtQkFBNUIsRUFBaUQsS0FBS0ssT0FBdEQsQ0FQL0I7O0FBQUE7QUFPY0ssZ0JBQUFBLFFBUGQ7QUFRUSxxQkFBS0Qsb0JBQUwsR0FBNEJDLFFBQTVCO0FBUlIsaURBU2VBLFFBVGY7O0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBWWNDLEtBQUsseURBWm5COztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE87Ozs7Ozs7O0FBZ0JBOzs7Ozt1R0FDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHVCQUMyQixLQUFLQyx1QkFBTCxFQUQzQjs7QUFBQTtBQUNVRixnQkFBQUEsUUFEVjtBQUFBLGtEQUVXQSxRQUZYOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE87Ozs7Ozs7Ozs7O3NIQUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQzJCLEtBQUtFLHVCQUFMLEVBRDNCOztBQUFBO0FBQ1VGLGdCQUFBQSxRQURWO0FBQUEsa0RBRVdBLFFBQVEsQ0FBQ0csMEJBQVQsRUFGWDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxPOzs7Ozs7Ozs7OzsyR0FLQSxrQkFBNkJDLFdBQTdCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQzJCLEtBQUtGLHVCQUFMLEVBRDNCOztBQUFBO0FBQ1VGLGdCQUFBQSxRQURWO0FBQUEsa0RBRVdBLFFBQVEsQ0FBQ0ssZUFBVCxDQUF5QkQsV0FBekIsQ0FGWDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxPOzs7Ozs7Ozs7Ozt1R0FLQSxrQkFBeUJFLFdBQXpCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQzJCLEtBQUtKLHVCQUFMLEVBRDNCOztBQUFBO0FBQ1VGLGdCQUFBQSxRQURWO0FBQUEsa0RBRVdBLFFBQVEsQ0FBQ08sV0FBVCxDQUFxQkQsV0FBckIsQ0FGWDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxPOzs7Ozs7OztBQUtDOzs7OztzSEFDRCxrQkFBd0NFLE9BQXhDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQzJCLEtBQUtOLHVCQUFMLEVBRDNCOztBQUFBO0FBQ1VGLGdCQUFBQSxRQURWO0FBQUEsa0RBRVdBLFFBQVEsQ0FBQ1MsU0FBVCxDQUFtQkMsMEJBQW5CLENBQThDRixPQUE5QyxDQUZYOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE87Ozs7Ozs7Ozs7O3VHQUtBLGtCQUF5QkcsSUFBekI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFDMkIsS0FBS1QsdUJBQUwsRUFEM0I7O0FBQUE7QUFDVUYsZ0JBQUFBLFFBRFY7QUFBQSxrREFFV0EsUUFBUSxDQUFDUyxTQUFULENBQW1CRyxXQUFuQixDQUErQkQsSUFBL0IsQ0FGWDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxPOzs7Ozs7OztBQUtBOzs7O1dBQ0Esb0JBQXlCRSxZQUF6QixFQUErQ0MsSUFBL0MsRUFBcUU7QUFDakUsYUFBTyx3QkFBT0MsUUFBUCxFQUFpQkYsWUFBakIsRUFBK0JDLElBQS9CLENBQVA7QUFDSDs7O1dBRUQsb0JBQXlCRSxJQUF6QixFQUEyRDtBQUN2RCxhQUFPLHdCQUFPRCxRQUFQLEVBQWlCQyxJQUFqQixDQUFQO0FBQ0giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250cmFjdFRyYW5zYWN0aW9uLCBldGhlcnMsIFNpZ25lciB9IGZyb20gXCJldGhlcnNcIjtcbmltcG9ydCB7IGdldE11bHRpc2lnRU5TQ29udHJhY3QgfSBmcm9tIFwiLi4vLi4vY2hhaW4vcHJlZmFiQ29udHJhY3RGYWN0b3J5XCI7XG5pbXBvcnQgeyBNdWx0aXNpZ0VOUyB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuXG5pbXBvcnQgKiBhcyBhcnRpZmFjdCBmcm9tIFwiLi4vLi4vZXRoZXJldW0vYWJpL011bHRpc2lnRU5TLmpzb25cIlxuaW1wb3J0IHsgZGVjb2RlLCBlbmNvZGUgfSBmcm9tIFwiLi4vLi4vZXRoZXJldW0vZW5jb2RlQ2FsbFwiO1xuaW1wb3J0IHsgUHJvdmlkZXJPclNpZ25lciB9IGZyb20gXCIuLi8uLi9sb2NhbFR5cGVzXCI7XG5pbXBvcnQgeyBEZWNvZGVkQ2FsbCB9IGZyb20gXCIuLi9oZWxwZXJzL2FiaURlY29kZXJDb250cm9sbGVyXCI7XG5cblxuZXhwb3J0IGNsYXNzIE11bHRpc2lnRU5TQ29udHJvbGxlciB7XG4gICAgcHJpdmF0ZSBfc2lnbmVyOiBTaWduZXI7XG4gICAgcHJpdmF0ZSBfbXVsdGlzaWdFTlNBZGRyZXNzIDogc3RyaW5nXG4gICAgcHJpdmF0ZSBfbXVsdGlzaWdFTlNDb250cmFjdD8gOiBNdWx0aXNpZ0VOU1xuXG4gICAgY29uc3RydWN0b3IobXVsdGlzaWdBZGRyZXNzOiBzdHJpbmcsIHNpZ25lck9yUHJvdmlkZXI6IFByb3ZpZGVyT3JTaWduZXIpIHtcbiAgICAgICAgdGhpcy5fbXVsdGlzaWdFTlNBZGRyZXNzID0gbXVsdGlzaWdBZGRyZXNzO1xuICAgICAgICBcbiAgICAgICAgaWYoc2lnbmVyT3JQcm92aWRlciBpbnN0YW5jZW9mIFNpZ25lciB8fCBzaWduZXJPclByb3ZpZGVyIGluc3RhbmNlb2YgZXRoZXJzLnByb3ZpZGVycy5Kc29uUnBjU2lnbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9zaWduZXIgPSBzaWduZXJPclByb3ZpZGVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgd2ViM1dyYXBwZXIgPSBuZXcgZXRoZXJzLnByb3ZpZGVycy5XZWIzUHJvdmlkZXIoc2lnbmVyT3JQcm92aWRlciBhcyBhbnkpIFxuICAgICAgICAgICAgdGhpcy5fc2lnbmVyID0gd2ViM1dyYXBwZXIuZ2V0U2lnbmVyKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgX2dldE11bHRpc2lnRU5TQ29udHJhY3QoKTogUHJvbWlzZTxNdWx0aXNpZ0VOUz4ge1xuICAgICAgICBpZih0aGlzLl9tdWx0aXNpZ0VOU0NvbnRyYWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbXVsdGlzaWdFTlNDb250cmFjdFxuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENvbm5lY3QgdG8gdGhlIGNvbnRyYWN0IHdpdGggbXkgc2lnbmVyXG4gICAgICAgICAgICBjb25zdCBjb250cmFjdCA9IGF3YWl0IGdldE11bHRpc2lnRU5TQ29udHJhY3QodGhpcy5fbXVsdGlzaWdFTlNBZGRyZXNzLCB0aGlzLl9zaWduZXIpXG4gICAgICAgICAgICB0aGlzLl9tdWx0aXNpZ0VOU0NvbnRyYWN0ID0gY29udHJhY3Q7XG4gICAgICAgICAgICByZXR1cm4gY29udHJhY3RcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYEZhaWxlZCB0byBnZXQgTXVsdGlzaWcgY29udHJhY3Q6ICR7ZX1gKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqR2V0dGVycyAqL1xuICAgIHB1YmxpYyBhc3luYyBnZXRDb250cmFjdCgpOiBQcm9taXNlPE11bHRpc2lnRU5TPiB7XG4gICAgICAgIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgdGhpcy5fZ2V0TXVsdGlzaWdFTlNDb250cmFjdCgpO1xuICAgICAgICByZXR1cm4gY29udHJhY3RcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0TXVsdGlzaWdEZXBsb3llckFkZHJlc3MoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgY29udHJhY3QgPSBhd2FpdCB0aGlzLl9nZXRNdWx0aXNpZ0VOU0NvbnRyYWN0KCk7XG4gICAgICAgIHJldHVybiBjb250cmFjdC5nZXRNdWx0aXNpZ0RlcGxveWVyQWRkcmVzcygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRNdWx0aXNpZ05hbWUobXNpZ0FkZHJlc3M6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgdGhpcy5fZ2V0TXVsdGlzaWdFTlNDb250cmFjdCgpO1xuICAgICAgICByZXR1cm4gY29udHJhY3QuZ2V0TXVsdGlzaWdOYW1lKG1zaWdBZGRyZXNzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0VXNlck5hbWUodXNlckFkZHJlc3M6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgdGhpcy5fZ2V0TXVsdGlzaWdFTlNDb250cmFjdCgpO1xuICAgICAgICByZXR1cm4gY29udHJhY3QuZ2V0VXNlck5hbWUodXNlckFkZHJlc3MpO1xuICAgIH1cblxuICAgICAvKipTZXR0ZXJzICovICBcbiAgICBwdWJsaWMgYXN5bmMgc2V0TXVsdGlzaWdEZXBsb3llckFkZHJlc3MoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxDb250cmFjdFRyYW5zYWN0aW9uPiB7XG4gICAgICAgIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgdGhpcy5fZ2V0TXVsdGlzaWdFTlNDb250cmFjdCgpO1xuICAgICAgICByZXR1cm4gY29udHJhY3QuZnVuY3Rpb25zLnNldE11bHRpc2lnRGVwbG95ZXJBZGRyZXNzKGFkZHJlc3MpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzZXRVc2VyTmFtZShuYW1lOiBzdHJpbmcpOiBQcm9taXNlPENvbnRyYWN0VHJhbnNhY3Rpb24+IHtcbiAgICAgICAgY29uc3QgY29udHJhY3QgPSBhd2FpdCB0aGlzLl9nZXRNdWx0aXNpZ0VOU0NvbnRyYWN0KCk7XG4gICAgICAgIHJldHVybiBjb250cmFjdC5mdW5jdGlvbnMuc2V0VXNlck5hbWUobmFtZSk7XG4gICAgfVxuXG4gICAgLyoqIEhlbHBlcnMgKi9cbiAgICBwdWJsaWMgc3RhdGljIGVuY29kZUNhbGwoZnVuY3Rpb25OYW1lOiBzdHJpbmcsIGFyZ3M/OiBhbnlbXSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBlbmNvZGUoYXJ0aWZhY3QsIGZ1bmN0aW9uTmFtZSwgYXJncylcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGRlY29kZUNhbGwoZGF0YTogc3RyaW5nKTogRGVjb2RlZENhbGwgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIGRlY29kZShhcnRpZmFjdCwgZGF0YSlcbiAgICB9XG59Il19