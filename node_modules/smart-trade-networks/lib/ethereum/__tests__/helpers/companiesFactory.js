"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.helperTestCompaniesFactory = exports.helperDeployCompaniesFactory = void 0;

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _ = require("../../../");

var _companyController = require("../../../companyController");

var _multisig = require("./multisig");

var helperDeployCompaniesFactory = /*#__PURE__*/function () {
  var _ref = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(signers, owner) {
    var companiesFactoryContract, companiesFactoryAddress, ownerOf;
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.next = 2;
            return _.CompaniesFactoryController.deployCompaniesFactory(signers[0], owner);

          case 2:
            companiesFactoryContract = _context.sent;
            companiesFactoryAddress = companiesFactoryContract.address;
            _context.next = 6;
            return companiesFactoryContract.owner();

          case 6:
            ownerOf = _context.sent;
            expect(owner).toEqual(ownerOf);
            return _context.abrupt("return", [companiesFactoryContract, companiesFactoryAddress]);

          case 9:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  }));

  return function helperDeployCompaniesFactory(_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

exports.helperDeployCompaniesFactory = helperDeployCompaniesFactory;

var helperTestCompaniesFactory = /*#__PURE__*/function () {
  var _ref2 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2(signers, companiesFactoryAddress, multisigContractAddress) {
    var controller, multisigController, company1Owner, company1Name, company1IpfsLink, company2Owner, company2Name, company2IpfsLink, company3Owner, company3Name, company3IpfsLink, createCompanyEncoded, companiesBySignatorie, company1Address, company1Controller, company1Data, getSignersByCompany, isCompanyOwner, company1Signer, controller1, getCompaniesBySignatorie, createCompany2Encoded, getCompanies, company2Address, controller2, createCompany3Encoded, company3Address, signer31, signer32, signer33, controller3;
    return _regenerator["default"].wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            controller = new _.CompaniesFactoryController(companiesFactoryAddress, signers[0]);
            multisigController = new _.MultisigController(multisigContractAddress, signers[0]);
            _context2.next = 4;
            return signers[3].getAddress();

          case 4:
            company1Owner = _context2.sent;
            company1Name = "Santiago Co";
            company1IpfsLink = '0x0000000000000000000000000000000000000000000000000000000000000000';
            _context2.next = 9;
            return signers[5].getAddress();

          case 9:
            company2Owner = _context2.sent;
            company2Name = "DelValle LTD";
            company2IpfsLink = '0x0000000000000000000000000000000000000000000000000000000000000000';
            _context2.next = 14;
            return signers[3].getAddress();

          case 14:
            company3Owner = _context2.sent;
            company3Name = "STN Co";
            company3IpfsLink = '0x0000000000000000000000000000000000000000000000000000000000000000'; //creates company1 with signers[3] as owner

            createCompanyEncoded = _.CompaniesFactoryController.encodeCall("createCompany", [company1Owner, company1Name, company1IpfsLink]);
            _context2.next = 20;
            return multisigController.submitTransaction(companiesFactoryAddress, 0, createCompanyEncoded, {
              gasLimit: 7500000
            });

          case 20:
            _context2.next = 22;
            return _context2.sent.wait();

          case 22:
            _context2.next = 24;
            return (0, _multisig.confirmLastMultisigTx)(multisigContractAddress, signers[1]);

          case 24:
            _context2.next = 26;
            return controller.getCompaniesBySignatorie(company1Owner);

          case 26:
            companiesBySignatorie = _context2.sent;
            expect(companiesBySignatorie.length).toEqual(1);
            company1Address = companiesBySignatorie[0];
            company1Controller = new _companyController.CompanyController(company1Address, signers[3]);
            _context2.next = 32;
            return company1Controller.getData();

          case 32:
            company1Data = _context2.sent;
            expect(company1Data.name).toEqual(company1Name);
            _context2.next = 36;
            return controller.getSignersByCompany(company1Address);

          case 36:
            getSignersByCompany = _context2.sent;
            expect(getSignersByCompany.length).toEqual(1);
            _context2.next = 40;
            return controller.isCompanyOwner(company1Address, company1Owner);

          case 40:
            isCompanyOwner = _context2.sent;
            expect(isCompanyOwner).toEqual(true); //adds signers[4] as signatorie to company1

            _context2.next = 44;
            return signers[4].getAddress();

          case 44:
            company1Signer = _context2.sent;
            controller1 = new _.CompaniesFactoryController(companiesFactoryAddress, signers[3]);
            _context2.next = 48;
            return controller1.addCompanySignatorie(company1Address, company1Signer);

          case 48:
            _context2.next = 50;
            return controller.getSignersByCompany(company1Address);

          case 50:
            getSignersByCompany = _context2.sent;
            expect(getSignersByCompany.length).toEqual(2);
            _context2.next = 54;
            return controller.getCompaniesBySignatorie(company1Signer);

          case 54:
            getCompaniesBySignatorie = _context2.sent;
            expect(getCompaniesBySignatorie.length).toEqual(1); //Creates a company2 with signers[5] as owner

            createCompany2Encoded = _.CompaniesFactoryController.encodeCall("createCompany", [company2Owner, company2Name, company2IpfsLink]);
            _context2.next = 59;
            return multisigController.submitTransaction(companiesFactoryAddress, 0, createCompany2Encoded, {
              gasLimit: 7500000
            });

          case 59:
            _context2.next = 61;
            return _context2.sent.wait();

          case 61:
            _context2.next = 63;
            return (0, _multisig.confirmLastMultisigTx)(multisigContractAddress, signers[1]);

          case 63:
            _context2.next = 65;
            return controller.getCompanies();

          case 65:
            getCompanies = _context2.sent;
            expect(getCompanies.length).toEqual(2);
            company2Address = getCompanies[1]; //adds signers[3] as signatorie to company2

            controller2 = new _.CompaniesFactoryController(companiesFactoryAddress, signers[5]);
            _context2.next = 71;
            return controller2.addCompanySignatorie(company2Address, company1Owner);

          case 71:
            _context2.next = 73;
            return controller.getSignersByCompany(company1Address);

          case 73:
            getSignersByCompany = _context2.sent;
            expect(getSignersByCompany.length).toEqual(2);
            _context2.next = 77;
            return controller.getCompaniesBySignatorie(company1Signer);

          case 77:
            getCompaniesBySignatorie = _context2.sent;
            expect(getCompaniesBySignatorie.length).toEqual(1); //signers[3] should be part of 2 companies now

            _context2.next = 81;
            return controller.getCompaniesBySignatorie(company1Owner);

          case 81:
            getCompaniesBySignatorie = _context2.sent;
            expect(getCompaniesBySignatorie.length).toEqual(2); //Creates a company3 with signers[3] as owner

            createCompany3Encoded = _.CompaniesFactoryController.encodeCall("createCompany", [company3Owner, company3Name, company3IpfsLink]);
            _context2.next = 86;
            return multisigController.submitTransaction(companiesFactoryAddress, 0, createCompany3Encoded, {
              gasLimit: 7500000
            });

          case 86:
            _context2.next = 88;
            return _context2.sent.wait();

          case 88:
            _context2.next = 90;
            return (0, _multisig.confirmLastMultisigTx)(multisigContractAddress, signers[1]);

          case 90:
            _context2.next = 92;
            return controller.getCompaniesBySignatorie(company1Owner);

          case 92:
            getCompaniesBySignatorie = _context2.sent;
            expect(getCompaniesBySignatorie.length).toEqual(3); //adds signer[2], [4], [5] to company3

            company3Address = getCompaniesBySignatorie[2];
            _context2.next = 97;
            return signers[2].getAddress();

          case 97:
            signer31 = _context2.sent;
            _context2.next = 100;
            return signers[4].getAddress();

          case 100:
            signer32 = _context2.sent;
            _context2.next = 103;
            return signers[5].getAddress();

          case 103:
            signer33 = _context2.sent;
            controller3 = new _.CompaniesFactoryController(companiesFactoryAddress, signers[3]);
            _context2.next = 107;
            return controller3.addCompanySignatorie(company3Address, signer31);

          case 107:
            _context2.next = 109;
            return controller3.addCompanySignatorie(company3Address, signer32);

          case 109:
            _context2.next = 111;
            return controller3.addCompanySignatorie(company3Address, signer33);

          case 111:
            _context2.next = 113;
            return controller.getSignersByCompany(company3Address);

          case 113:
            getSignersByCompany = _context2.sent;
            expect(getSignersByCompany.length).toEqual(4); //removes signer[2]

            _context2.next = 117;
            return controller3.removeCompanySignatorie(company3Address, signer31);

          case 117:
            _context2.next = 119;
            return controller.getSignersByCompany(company3Address);

          case 119:
            getSignersByCompany = _context2.sent;
            expect(getSignersByCompany.length).toEqual(3);
            expect(getSignersByCompany).toEqual(expect.arrayContaining([signer32, signer33, company3Owner]));
            _context2.next = 124;
            return controller.getCompaniesBySignatorie(signer31);

          case 124:
            getCompaniesBySignatorie = _context2.sent;
            expect(getCompaniesBySignatorie.length).toEqual(0); //const isSignerApproved = await controller.isSignerApproved()

          case 126:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  }));

  return function helperTestCompaniesFactory(_x3, _x4, _x5) {
    return _ref2.apply(this, arguments);
  };
}();

exports.helperTestCompaniesFactory = helperTestCompaniesFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9ldGhlcmV1bS9fX3Rlc3RzX18vaGVscGVycy9jb21wYW5pZXNGYWN0b3J5LnRzIl0sIm5hbWVzIjpbImhlbHBlckRlcGxveUNvbXBhbmllc0ZhY3RvcnkiLCJzaWduZXJzIiwib3duZXIiLCJDb21wYW5pZXNGYWN0b3J5Q29udHJvbGxlciIsImRlcGxveUNvbXBhbmllc0ZhY3RvcnkiLCJjb21wYW5pZXNGYWN0b3J5Q29udHJhY3QiLCJjb21wYW5pZXNGYWN0b3J5QWRkcmVzcyIsImFkZHJlc3MiLCJvd25lck9mIiwiZXhwZWN0IiwidG9FcXVhbCIsImhlbHBlclRlc3RDb21wYW5pZXNGYWN0b3J5IiwibXVsdGlzaWdDb250cmFjdEFkZHJlc3MiLCJjb250cm9sbGVyIiwibXVsdGlzaWdDb250cm9sbGVyIiwiTXVsdGlzaWdDb250cm9sbGVyIiwiZ2V0QWRkcmVzcyIsImNvbXBhbnkxT3duZXIiLCJjb21wYW55MU5hbWUiLCJjb21wYW55MUlwZnNMaW5rIiwiY29tcGFueTJPd25lciIsImNvbXBhbnkyTmFtZSIsImNvbXBhbnkySXBmc0xpbmsiLCJjb21wYW55M093bmVyIiwiY29tcGFueTNOYW1lIiwiY29tcGFueTNJcGZzTGluayIsImNyZWF0ZUNvbXBhbnlFbmNvZGVkIiwiZW5jb2RlQ2FsbCIsInN1Ym1pdFRyYW5zYWN0aW9uIiwiZ2FzTGltaXQiLCJ3YWl0IiwiZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllIiwiY29tcGFuaWVzQnlTaWduYXRvcmllIiwibGVuZ3RoIiwiY29tcGFueTFBZGRyZXNzIiwiY29tcGFueTFDb250cm9sbGVyIiwiQ29tcGFueUNvbnRyb2xsZXIiLCJnZXREYXRhIiwiY29tcGFueTFEYXRhIiwibmFtZSIsImdldFNpZ25lcnNCeUNvbXBhbnkiLCJpc0NvbXBhbnlPd25lciIsImNvbXBhbnkxU2lnbmVyIiwiY29udHJvbGxlcjEiLCJhZGRDb21wYW55U2lnbmF0b3JpZSIsImNyZWF0ZUNvbXBhbnkyRW5jb2RlZCIsImdldENvbXBhbmllcyIsImNvbXBhbnkyQWRkcmVzcyIsImNvbnRyb2xsZXIyIiwiY3JlYXRlQ29tcGFueTNFbmNvZGVkIiwiY29tcGFueTNBZGRyZXNzIiwic2lnbmVyMzEiLCJzaWduZXIzMiIsInNpZ25lcjMzIiwiY29udHJvbGxlcjMiLCJyZW1vdmVDb21wYW55U2lnbmF0b3JpZSIsImFycmF5Q29udGFpbmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUNBOztBQUNBOztBQUVBOztBQUlPLElBQU1BLDRCQUE0QjtBQUFBLDJGQUFHLGlCQUFPQyxPQUFQLEVBQXNDQyxLQUF0QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUNrQkMsNkJBQTJCQyxzQkFBM0IsQ0FBa0RILE9BQU8sQ0FBQyxDQUFELENBQXpELEVBQThEQyxLQUE5RCxDQURsQjs7QUFBQTtBQUNsQ0csWUFBQUEsd0JBRGtDO0FBRWxDQyxZQUFBQSx1QkFGa0MsR0FFUkQsd0JBQXdCLENBQUNFLE9BRmpCO0FBQUE7QUFBQSxtQkFHbEJGLHdCQUF3QixDQUFDSCxLQUF6QixFQUhrQjs7QUFBQTtBQUdsQ00sWUFBQUEsT0FIa0M7QUFJeENDLFlBQUFBLE1BQU0sQ0FBQ1AsS0FBRCxDQUFOLENBQWNRLE9BQWQsQ0FBc0JGLE9BQXRCO0FBSndDLDZDQUtqQyxDQUFDSCx3QkFBRCxFQUEyQkMsdUJBQTNCLENBTGlDOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQUg7O0FBQUEsa0JBQTVCTiw0QkFBNEI7QUFBQTtBQUFBO0FBQUEsR0FBbEM7Ozs7QUFRQSxJQUFNVywwQkFBMEI7QUFBQSw0RkFBRyxrQkFDdENWLE9BRHNDLEVBRXRDSyx1QkFGc0MsRUFHdENNLHVCQUhzQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFLaENDLFlBQUFBLFVBTGdDLEdBS25CLElBQUlWLDRCQUFKLENBQStCRyx1QkFBL0IsRUFBd0RMLE9BQU8sQ0FBQyxDQUFELENBQS9ELENBTG1C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QkFBMEI7QUFBQTtBQUFBO0FBQUEsR0FBaEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldGhlcnMgfSBmcm9tIFwiZXRoZXJzXCI7XG5pbXBvcnQgeyBNdWx0aXNpZ0NvbnRyb2xsZXIsIENvbXBhbmllc0ZhY3RvcnlDb250cm9sbGVyIH0gZnJvbSBcIi4uLy4uLy4uL1wiO1xuaW1wb3J0IHsgQ29tcGFueUNvbnRyb2xsZXIgfSBmcm9tIFwiLi4vLi4vLi4vY29tcGFueUNvbnRyb2xsZXJcIjtcbmltcG9ydCB7IENvbXBhbmllc0ZhY3RvcnkgfSBmcm9tIFwiLi4vLi4vLi4vdHlwZXNcIjtcbmltcG9ydCB7IGNvbmZpcm1MYXN0TXVsdGlzaWdUeCB9IGZyb20gXCIuL211bHRpc2lnXCI7XG5cblxuXG5leHBvcnQgY29uc3QgaGVscGVyRGVwbG95Q29tcGFuaWVzRmFjdG9yeSA9IGFzeW5jIChzaWduZXJzOiBBcnJheTxldGhlcnMuU2lnbmVyPiwgb3duZXI6IHN0cmluZyk6IFByb21pc2U8W0NvbXBhbmllc0ZhY3RvcnksIHN0cmluZ10+ID0+IHtcbiAgICBjb25zdCBjb21wYW5pZXNGYWN0b3J5Q29udHJhY3Q6IENvbXBhbmllc0ZhY3RvcnkgID0gYXdhaXQgQ29tcGFuaWVzRmFjdG9yeUNvbnRyb2xsZXIuZGVwbG95Q29tcGFuaWVzRmFjdG9yeShzaWduZXJzWzBdLCBvd25lcik7XG4gICAgY29uc3QgY29tcGFuaWVzRmFjdG9yeUFkZHJlc3MgPSBjb21wYW5pZXNGYWN0b3J5Q29udHJhY3QuYWRkcmVzcztcbiAgICBjb25zdCBvd25lck9mID0gYXdhaXQgY29tcGFuaWVzRmFjdG9yeUNvbnRyYWN0Lm93bmVyKCk7XG4gICAgZXhwZWN0KG93bmVyKS50b0VxdWFsKG93bmVyT2YpO1xuICAgIHJldHVybiBbY29tcGFuaWVzRmFjdG9yeUNvbnRyYWN0LCBjb21wYW5pZXNGYWN0b3J5QWRkcmVzc107XG59XG5cbmV4cG9ydCBjb25zdCBoZWxwZXJUZXN0Q29tcGFuaWVzRmFjdG9yeSA9IGFzeW5jIChcbiAgICBzaWduZXJzOiBBcnJheTxldGhlcnMuU2lnbmVyPiwgXG4gICAgY29tcGFuaWVzRmFjdG9yeUFkZHJlc3M6IHN0cmluZywgXG4gICAgbXVsdGlzaWdDb250cmFjdEFkZHJlc3M6IHN0cmluZ1xuKSA9PiB7XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBDb21wYW5pZXNGYWN0b3J5Q29udHJvbGxlcihjb21wYW5pZXNGYWN0b3J5QWRkcmVzcywgc2lnbmVyc1swXSk7XG4gICAgY29uc3QgbXVsdGlzaWdDb250cm9sbGVyID0gbmV3IE11bHRpc2lnQ29udHJvbGxlcihtdWx0aXNpZ0NvbnRyYWN0QWRkcmVzcywgc2lnbmVyc1swXSk7XG4gICAgY29uc3QgY29tcGFueTFPd25lciA9IGF3YWl0IHNpZ25lcnNbM10uZ2V0QWRkcmVzcygpO1xuICAgIGNvbnN0IGNvbXBhbnkxTmFtZSA9IFwiU2FudGlhZ28gQ29cIjtcbiAgICBjb25zdCBjb21wYW55MUlwZnNMaW5rID0nMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJztcblxuICAgIGNvbnN0IGNvbXBhbnkyT3duZXIgPSBhd2FpdCBzaWduZXJzWzVdLmdldEFkZHJlc3MoKTtcbiAgICBjb25zdCBjb21wYW55Mk5hbWUgPSBcIkRlbFZhbGxlIExURFwiO1xuICAgIGNvbnN0IGNvbXBhbnkySXBmc0xpbmsgPScweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAnO1xuXG4gICAgY29uc3QgY29tcGFueTNPd25lciA9IGF3YWl0IHNpZ25lcnNbM10uZ2V0QWRkcmVzcygpO1xuICAgIGNvbnN0IGNvbXBhbnkzTmFtZSA9IFwiU1ROIENvXCI7XG4gICAgY29uc3QgY29tcGFueTNJcGZzTGluayA9JzB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCc7XG5cbiAgICAvL2NyZWF0ZXMgY29tcGFueTEgd2l0aCBzaWduZXJzWzNdIGFzIG93bmVyXG4gICAgY29uc3QgY3JlYXRlQ29tcGFueUVuY29kZWQgPSBDb21wYW5pZXNGYWN0b3J5Q29udHJvbGxlci5lbmNvZGVDYWxsKFwiY3JlYXRlQ29tcGFueVwiLCBbY29tcGFueTFPd25lciwgY29tcGFueTFOYW1lLCBjb21wYW55MUlwZnNMaW5rXSk7XG4gICAgYXdhaXQgKGF3YWl0IG11bHRpc2lnQ29udHJvbGxlci5zdWJtaXRUcmFuc2FjdGlvbihjb21wYW5pZXNGYWN0b3J5QWRkcmVzcywgMCwgY3JlYXRlQ29tcGFueUVuY29kZWQsIHsgZ2FzTGltaXQ6IDc1MDAwMDB9KSkud2FpdCgpXG4gICAgYXdhaXQgY29uZmlybUxhc3RNdWx0aXNpZ1R4KG11bHRpc2lnQ29udHJhY3RBZGRyZXNzLCBzaWduZXJzWzFdKTtcblxuICAgIGxldCBjb21wYW5pZXNCeVNpZ25hdG9yaWUgPSBhd2FpdCBjb250cm9sbGVyLmdldENvbXBhbmllc0J5U2lnbmF0b3JpZShjb21wYW55MU93bmVyKTtcbiAgICBleHBlY3QoY29tcGFuaWVzQnlTaWduYXRvcmllLmxlbmd0aCkudG9FcXVhbCgxKTtcblxuICAgIGNvbnN0IGNvbXBhbnkxQWRkcmVzcyA9IGNvbXBhbmllc0J5U2lnbmF0b3JpZVswXTtcbiAgICBjb25zdCBjb21wYW55MUNvbnRyb2xsZXIgPSBuZXcgQ29tcGFueUNvbnRyb2xsZXIoY29tcGFueTFBZGRyZXNzLCBzaWduZXJzWzNdKTtcbiAgICBjb25zdCBjb21wYW55MURhdGEgPSBhd2FpdCBjb21wYW55MUNvbnRyb2xsZXIuZ2V0RGF0YSgpO1xuICAgIGV4cGVjdChjb21wYW55MURhdGEubmFtZSkudG9FcXVhbChjb21wYW55MU5hbWUpO1xuICAgIGxldCBnZXRTaWduZXJzQnlDb21wYW55ID0gYXdhaXQgY29udHJvbGxlci5nZXRTaWduZXJzQnlDb21wYW55KGNvbXBhbnkxQWRkcmVzcyk7XG4gICAgZXhwZWN0KGdldFNpZ25lcnNCeUNvbXBhbnkubGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgIGNvbnN0IGlzQ29tcGFueU93bmVyID0gYXdhaXQgY29udHJvbGxlci5pc0NvbXBhbnlPd25lcihjb21wYW55MUFkZHJlc3MsIGNvbXBhbnkxT3duZXIpO1xuICAgIGV4cGVjdChpc0NvbXBhbnlPd25lcikudG9FcXVhbCh0cnVlKTtcblxuICAgIC8vYWRkcyBzaWduZXJzWzRdIGFzIHNpZ25hdG9yaWUgdG8gY29tcGFueTFcbiAgICBjb25zdCBjb21wYW55MVNpZ25lciA9IGF3YWl0IHNpZ25lcnNbNF0uZ2V0QWRkcmVzcygpO1xuICAgIGNvbnN0IGNvbnRyb2xsZXIxID0gbmV3IENvbXBhbmllc0ZhY3RvcnlDb250cm9sbGVyKGNvbXBhbmllc0ZhY3RvcnlBZGRyZXNzLCBzaWduZXJzWzNdKTtcbiAgICBhd2FpdCBjb250cm9sbGVyMS5hZGRDb21wYW55U2lnbmF0b3JpZShjb21wYW55MUFkZHJlc3MsIGNvbXBhbnkxU2lnbmVyKTtcbiAgICBnZXRTaWduZXJzQnlDb21wYW55ID0gYXdhaXQgY29udHJvbGxlci5nZXRTaWduZXJzQnlDb21wYW55KGNvbXBhbnkxQWRkcmVzcyk7XG4gICAgZXhwZWN0KGdldFNpZ25lcnNCeUNvbXBhbnkubGVuZ3RoKS50b0VxdWFsKDIpO1xuICAgIGxldCBnZXRDb21wYW5pZXNCeVNpZ25hdG9yaWUgPSBhd2FpdCBjb250cm9sbGVyLmdldENvbXBhbmllc0J5U2lnbmF0b3JpZShjb21wYW55MVNpZ25lcik7XG4gICAgZXhwZWN0KGdldENvbXBhbmllc0J5U2lnbmF0b3JpZS5sZW5ndGgpLnRvRXF1YWwoMSk7XG5cblxuICAgIC8vQ3JlYXRlcyBhIGNvbXBhbnkyIHdpdGggc2lnbmVyc1s1XSBhcyBvd25lclxuICAgIGNvbnN0IGNyZWF0ZUNvbXBhbnkyRW5jb2RlZCA9IENvbXBhbmllc0ZhY3RvcnlDb250cm9sbGVyLmVuY29kZUNhbGwoXCJjcmVhdGVDb21wYW55XCIsIFtjb21wYW55Mk93bmVyLCBjb21wYW55Mk5hbWUsIGNvbXBhbnkySXBmc0xpbmtdKTtcbiAgICBhd2FpdCAoYXdhaXQgbXVsdGlzaWdDb250cm9sbGVyLnN1Ym1pdFRyYW5zYWN0aW9uKGNvbXBhbmllc0ZhY3RvcnlBZGRyZXNzLCAwLCBjcmVhdGVDb21wYW55MkVuY29kZWQsIHsgZ2FzTGltaXQ6IDc1MDAwMDB9KSkud2FpdCgpXG4gICAgYXdhaXQgY29uZmlybUxhc3RNdWx0aXNpZ1R4KG11bHRpc2lnQ29udHJhY3RBZGRyZXNzLCBzaWduZXJzWzFdKTtcblxuICAgIGNvbnN0IGdldENvbXBhbmllcyA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Q29tcGFuaWVzKCk7XG4gICAgZXhwZWN0KGdldENvbXBhbmllcy5sZW5ndGgpLnRvRXF1YWwoMik7XG4gICAgY29uc3QgY29tcGFueTJBZGRyZXNzID0gZ2V0Q29tcGFuaWVzWzFdO1xuXG4gICAgLy9hZGRzIHNpZ25lcnNbM10gYXMgc2lnbmF0b3JpZSB0byBjb21wYW55MlxuICAgIGNvbnN0IGNvbnRyb2xsZXIyID0gbmV3IENvbXBhbmllc0ZhY3RvcnlDb250cm9sbGVyKGNvbXBhbmllc0ZhY3RvcnlBZGRyZXNzLCBzaWduZXJzWzVdKTtcbiAgICBhd2FpdCBjb250cm9sbGVyMi5hZGRDb21wYW55U2lnbmF0b3JpZShjb21wYW55MkFkZHJlc3MsIGNvbXBhbnkxT3duZXIpO1xuICAgIGdldFNpZ25lcnNCeUNvbXBhbnkgPSBhd2FpdCBjb250cm9sbGVyLmdldFNpZ25lcnNCeUNvbXBhbnkoY29tcGFueTFBZGRyZXNzKTtcbiAgICBleHBlY3QoZ2V0U2lnbmVyc0J5Q29tcGFueS5sZW5ndGgpLnRvRXF1YWwoMik7XG4gICAgZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllID0gYXdhaXQgY29udHJvbGxlci5nZXRDb21wYW5pZXNCeVNpZ25hdG9yaWUoY29tcGFueTFTaWduZXIpO1xuICAgIGV4cGVjdChnZXRDb21wYW5pZXNCeVNpZ25hdG9yaWUubGVuZ3RoKS50b0VxdWFsKDEpO1xuXG4gICAgLy9zaWduZXJzWzNdIHNob3VsZCBiZSBwYXJ0IG9mIDIgY29tcGFuaWVzIG5vd1xuICAgIGdldENvbXBhbmllc0J5U2lnbmF0b3JpZSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllKGNvbXBhbnkxT3duZXIpO1xuICAgIGV4cGVjdChnZXRDb21wYW5pZXNCeVNpZ25hdG9yaWUubGVuZ3RoKS50b0VxdWFsKDIpO1xuXG4gICAgLy9DcmVhdGVzIGEgY29tcGFueTMgd2l0aCBzaWduZXJzWzNdIGFzIG93bmVyXG4gICAgY29uc3QgY3JlYXRlQ29tcGFueTNFbmNvZGVkID0gQ29tcGFuaWVzRmFjdG9yeUNvbnRyb2xsZXIuZW5jb2RlQ2FsbChcImNyZWF0ZUNvbXBhbnlcIiwgW2NvbXBhbnkzT3duZXIsIGNvbXBhbnkzTmFtZSwgY29tcGFueTNJcGZzTGlua10pO1xuICAgIGF3YWl0IChhd2FpdCBtdWx0aXNpZ0NvbnRyb2xsZXIuc3VibWl0VHJhbnNhY3Rpb24oY29tcGFuaWVzRmFjdG9yeUFkZHJlc3MsIDAsIGNyZWF0ZUNvbXBhbnkzRW5jb2RlZCwgeyBnYXNMaW1pdDogNzUwMDAwMH0pKS53YWl0KClcbiAgICBhd2FpdCBjb25maXJtTGFzdE11bHRpc2lnVHgobXVsdGlzaWdDb250cmFjdEFkZHJlc3MsIHNpZ25lcnNbMV0pO1xuXG4gICAgLy9zaWduZXJzWzNdIHNob3VsZCBiZSBwYXJ0IG9mIDMgY29tcGFuaWVzIG5vd1xuICAgIGdldENvbXBhbmllc0J5U2lnbmF0b3JpZSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllKGNvbXBhbnkxT3duZXIpO1xuICAgIGV4cGVjdChnZXRDb21wYW5pZXNCeVNpZ25hdG9yaWUubGVuZ3RoKS50b0VxdWFsKDMpO1xuXG4gICAgLy9hZGRzIHNpZ25lclsyXSwgWzRdLCBbNV0gdG8gY29tcGFueTNcbiAgICBjb25zdCBjb21wYW55M0FkZHJlc3M9IGdldENvbXBhbmllc0J5U2lnbmF0b3JpZVsyXTtcbiAgICBjb25zdCBzaWduZXIzMSA9IGF3YWl0IHNpZ25lcnNbMl0uZ2V0QWRkcmVzcygpO1xuICAgIGNvbnN0IHNpZ25lcjMyID0gYXdhaXQgc2lnbmVyc1s0XS5nZXRBZGRyZXNzKCk7XG4gICAgY29uc3Qgc2lnbmVyMzMgPSBhd2FpdCBzaWduZXJzWzVdLmdldEFkZHJlc3MoKTtcbiAgICBjb25zdCBjb250cm9sbGVyMyA9IG5ldyBDb21wYW5pZXNGYWN0b3J5Q29udHJvbGxlcihjb21wYW5pZXNGYWN0b3J5QWRkcmVzcywgc2lnbmVyc1szXSk7XG4gICAgYXdhaXQgY29udHJvbGxlcjMuYWRkQ29tcGFueVNpZ25hdG9yaWUoY29tcGFueTNBZGRyZXNzLCBzaWduZXIzMSk7XG4gICAgYXdhaXQgY29udHJvbGxlcjMuYWRkQ29tcGFueVNpZ25hdG9yaWUoY29tcGFueTNBZGRyZXNzLCBzaWduZXIzMik7XG4gICAgYXdhaXQgY29udHJvbGxlcjMuYWRkQ29tcGFueVNpZ25hdG9yaWUoY29tcGFueTNBZGRyZXNzLCBzaWduZXIzMyk7XG4gICAgZ2V0U2lnbmVyc0J5Q29tcGFueSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0U2lnbmVyc0J5Q29tcGFueShjb21wYW55M0FkZHJlc3MpO1xuICAgIGV4cGVjdChnZXRTaWduZXJzQnlDb21wYW55Lmxlbmd0aCkudG9FcXVhbCg0KTtcblxuICAgIC8vcmVtb3ZlcyBzaWduZXJbMl1cbiAgICBhd2FpdCBjb250cm9sbGVyMy5yZW1vdmVDb21wYW55U2lnbmF0b3JpZShjb21wYW55M0FkZHJlc3MsIHNpZ25lcjMxKTtcbiAgICBnZXRTaWduZXJzQnlDb21wYW55ID0gYXdhaXQgY29udHJvbGxlci5nZXRTaWduZXJzQnlDb21wYW55KGNvbXBhbnkzQWRkcmVzcyk7XG4gICAgZXhwZWN0KGdldFNpZ25lcnNCeUNvbXBhbnkubGVuZ3RoKS50b0VxdWFsKDMpO1xuICAgIGV4cGVjdChnZXRTaWduZXJzQnlDb21wYW55KS50b0VxdWFsKGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW3NpZ25lcjMyLCBzaWduZXIzMywgY29tcGFueTNPd25lcl0pKTtcblxuICAgIGdldENvbXBhbmllc0J5U2lnbmF0b3JpZSA9IGF3YWl0IGNvbnRyb2xsZXIuZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllKHNpZ25lcjMxKTtcbiAgICBleHBlY3QoZ2V0Q29tcGFuaWVzQnlTaWduYXRvcmllLmxlbmd0aCkudG9FcXVhbCgwKTtcblxuICAgIC8vY29uc3QgaXNTaWduZXJBcHByb3ZlZCA9IGF3YWl0IGNvbnRyb2xsZXIuaXNTaWduZXJBcHByb3ZlZCgpXG5cbn1cbiJdfQ==